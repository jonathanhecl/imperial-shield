<Window x:Class="ImperialShield.Views.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="⚔️ Imperial Shield - Centro de Comando" 
        Height="950" Width="1150"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource ModernWindow}">

    <Window.Resources>
        <!-- RPG-Style Gradients -->
        <LinearGradientBrush x:Key="EpicHeaderGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#0a1628" Offset="0"/>
            <GradientStop Color="#1a3a5c" Offset="0.5"/>
            <GradientStop Color="#0d2847" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="GoldAccent" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#B8860B" Offset="0"/>
            <GradientStop Color="#FFD700" Offset="0.5"/>
            <GradientStop Color="#B8860B" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="ShieldGlow" StartPoint="0.5,0" EndPoint="0.5,1">
            <GradientStop Color="#4DA8DA" Offset="0"/>
            <GradientStop Color="#1E5A82" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="CardGradient" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#1B3044" Offset="0"/>
            <GradientStop Color="#0F1C2E" Offset="1"/>
        </LinearGradientBrush>

        <!-- RPG Card Style -->
        <Style x:Key="RPGCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardGradient}"/>
            <Setter Property="BorderBrush" Value="#3A5F82"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="3" Opacity="0.5" Color="#000"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Stat Card Style -->
        <Style x:Key="StatCard" TargetType="Border">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#1E3A5F" Offset="0"/>
                        <GradientStop Color="#0D1B2A" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BorderBrush" Value="#4DA8DA"/>
            <Setter Property="BorderThickness" Value="1,1,1,3"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.4" Color="#4DA8DA"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Action Button RPG Style -->
        <Style x:Key="RPGButton" TargetType="Button">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#2E5077" Offset="0"/>
                        <GradientStop Color="#1E3A5F" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="#E8F4FC"/>
            <Setter Property="BorderBrush" Value="#4DA8DA"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="8" ShadowDepth="1" Opacity="0.3" Color="#4DA8DA"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Color="#3A6A9A" Offset="0"/>
                                            <GradientStop Color="#2E5077" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="border" Property="BorderBrush" Value="#7CC4F0"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#1A3A5A"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Storyboard x:Key="StatusPulse">
            <DoubleAnimation Storyboard.TargetName="StatusGlow" 
                             Storyboard.TargetProperty="Opacity"
                             From="0.4" To="1.0" Duration="0:0:1" 
                             AutoReverse="True" RepeatBehavior="Forever"/>
            <DoubleAnimation Storyboard.TargetName="StatusDot" 
                             Storyboard.TargetProperty="Opacity"
                             From="0.7" To="1.0" Duration="0:0:1" 
                             AutoReverse="True" RepeatBehavior="Forever"/>
        </Storyboard>
    </Window.Resources>
    
    <Window.Triggers>
        <EventTrigger RoutedEvent="Window.Loaded">
            <BeginStoryboard Storyboard="{StaticResource StatusPulse}"/>
        </EventTrigger>
    </Window.Triggers>

    <!-- Main Container with decorative border -->
    <Border Padding="0" Background="#080F1A">
        <Grid>
            <!-- Background Pattern Overlay -->
            <Border Opacity="0.03">
                <Border.Background>
                    <VisualBrush TileMode="Tile" Viewport="0,0,50,50" ViewportUnits="Absolute">
                        <VisualBrush.Visual>
                            <Path Data="M0,0 L25,25 L50,0 L50,50 L25,25 L0,50 Z" 
                                  Fill="#4DA8DA" Stroke="#4DA8DA" StrokeThickness="0.5"/>
                        </VisualBrush.Visual>
                    </VisualBrush>
                </Border.Background>
            </Border>

            <Grid Margin="25">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- ═══════════════════ EPIC HEADER ═══════════════════ -->
                <Border Grid.Row="0" Background="{StaticResource EpicHeaderGradient}" 
                        CornerRadius="12" Padding="25" Margin="0,0,0,20"
                        BorderBrush="#4DA8DA" BorderThickness="1">
                    <Border.Effect>
                        <DropShadowEffect BlurRadius="25" ShadowDepth="0" Opacity="0.5" Color="#4DA8DA"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Shield Logo with Glow -->
                        <Border Grid.Column="0" Width="80" Height="80" Margin="0,0,25,0">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="20" ShadowDepth="0" Opacity="0.7" Color="#4DA8DA"/>
                            </Border.Effect>
                            <Image Source="/Resources/shield.png" Stretch="Uniform"/>
                        </Border>

                        <!-- Title Section -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock FontSize="36" FontWeight="Bold" Foreground="White">
                                <Run Text="IMPERIAL" Foreground="#4DA8DA"/>
                                <Run Text=" SHIELD"/>
                            </TextBlock>
                            <TextBlock Text="⚔️ Centro de Comando de Seguridad ⚔️" 
                                       FontSize="14" Foreground="#7EB8DC" Margin="0,5,0,0"
                                       FontStyle="Italic"/>
                        </StackPanel>

                        <!-- Status Badge and Controls -->
                        <StackPanel Grid.Column="2" VerticalAlignment="Center" Orientation="Horizontal">
                             <!-- Pause/Resume Button -->
                             <Button x:Name="PauseButton" Click="PauseButton_Click" Cursor="Hand"
                                     Background="Transparent" BorderThickness="0" Margin="0,0,15,0">
                                 <Button.ToolTip>
                                     <ToolTip Background="#0A1525" Foreground="#E8F4FC" BorderBrush="#4DA8DA" BorderThickness="1" Padding="10,8">
                                         <TextBlock Text="Detener temporalmente todos los monitores" FontSize="12"/>
                                     </ToolTip>
                                 </Button.ToolTip>
                                 <Border x:Name="PauseButtonBorder" CornerRadius="6" Padding="16,10"
                                         BorderBrush="#4DA8DA" BorderThickness="1.5">
                                     <Border.Background>
                                         <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                             <GradientStop Color="#1A3A5A" Offset="0"/>
                                             <GradientStop Color="#0D1B2A" Offset="1"/>
                                         </LinearGradientBrush>
                                     </Border.Background>
                                     <StackPanel Orientation="Horizontal">
                                         <TextBlock x:Name="PauseIcon" Text="⏸" FontSize="14" Margin="0,0,8,0" 
                                                    VerticalAlignment="Center" Foreground="#4DA8DA"/>
                                         <TextBlock x:Name="PauseText" Text="PAUSAR" Foreground="#E8F4FC" 
                                                    FontWeight="SemiBold" FontSize="13" VerticalAlignment="Center"/>
                                     </StackPanel>
                                 </Border>
                             </Button>

                             <Border x:Name="StatusBadge" CornerRadius="25" Padding="20,10"
                                     VerticalAlignment="Center"
                                     BorderThickness="2" BorderBrush="#27AE60">
                                 <Border.Background>
                                     <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                         <GradientStop Color="#1A4D2E" Offset="0"/>
                                         <GradientStop Color="#0D2818" Offset="1"/>
                                     </LinearGradientBrush>
                                 </Border.Background>
                                 <StackPanel Orientation="Horizontal">
                                     <Ellipse x:Name="StatusDot" Width="12" Height="12" Margin="0,0,10,0">
                                         <Ellipse.Fill>
                                             <RadialGradientBrush>
                                                 <GradientStop Color="#5CFF5C" Offset="0"/>
                                                 <GradientStop Color="#27AE60" Offset="1"/>
                                             </RadialGradientBrush>
                                         </Ellipse.Fill>
                                         <Ellipse.Effect>
                                             <DropShadowEffect x:Name="StatusGlow" BlurRadius="8" ShadowDepth="0" Color="#27AE60"/>
                                         </Ellipse.Effect>
                                     </Ellipse>
                                     <TextBlock x:Name="StatusText" Text="PROTEGIDO" 
                                                Foreground="#5CFF5C" FontWeight="Bold" FontSize="14"
                                                VerticalAlignment="Center"/>
                                 </StackPanel>
                             </Border>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- ═══════════════════ MAIN PANELS ═══════════════════ -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Arsenal (Tools) Panel -->
                    <Border Grid.Column="0" Style="{StaticResource RPGCard}" Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                                <Border Width="32" Height="32" CornerRadius="6" Background="#1E3A5F" Margin="0,0,10,0" Padding="4">
                                    <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="ARSENAL DE INVESTIGACIÓN" FontSize="16" FontWeight="Bold" 
                                           Foreground="#4DA8DA" VerticalAlignment="Center" />
                            </StackPanel>

                            <!-- 3xN Grid of Buttons with Scroll - Compact Layout -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                <UniformGrid Columns="3" VerticalAlignment="Top">
                                    <Button x:Name="ArsenalProcessBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="ProcessViewer_Click" ToolTip="Visor de Procesos">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE713;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="PROCESOS" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalProcessCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>
                                    
                                    <Button x:Name="ArsenalNetBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="NetworkViewer_Click" ToolTip="Monitor de Conexiones">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="CONEXIONES" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalNetCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="ArsenalStartupBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="StartupManager_Click" ToolTip="Gestor de Inicio">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE7B8;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="INICIO" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalStartupCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="ArsenalTasksBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="ScheduledTasks_Click" ToolTip="Monitor de Tareas">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="TAREAS" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalTasksCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="ArsenalPrivacyBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="Privacy_Click" ToolTip="Centro de Privacidad">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE890;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="PRIVACIDAD" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalPrivacyCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>

                                    <Button x:Name="ArsenalQuarantineBtn" Style="{StaticResource RPGButton}" Height="90" Margin="3"
                                            Click="Quarantine_Click" ToolTip="Centro de Cuarentena">
                                        <StackPanel HorizontalAlignment="Center">
                                            <TextBlock Text="&#xE730;" FontFamily="Segoe MDL2 Assets" FontSize="32" 
                                                       HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="#4DA8DA">
                                                <TextBlock.Effect>
                                                    <DropShadowEffect BlurRadius="12" ShadowDepth="0" Color="#4DA8DA" Opacity="0.8"/>
                                                </TextBlock.Effect>
                                            </TextBlock>
                                            <TextBlock Text="CUARENTENA" FontSize="10" HorizontalAlignment="Center" Foreground="#E8F4FC" FontWeight="SemiBold"/>
                                            <TextBlock x:Name="ArsenalQuarantineCount" Text="..." FontSize="9" HorizontalAlignment="Center" Foreground="#7EB8DC"/>
                                        </StackPanel>
                                    </Button>
                                </UniformGrid>
                            </ScrollViewer>
                        </Grid>
                    </Border>

                    <!-- Monitoring Status Panel -->
                    <Border Grid.Column="1" Style="{StaticResource RPGCard}" Margin="10,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                                <Border Width="32" Height="32" CornerRadius="6" Background="#1E3A5F" Margin="0,0,10,0" Padding="4">
                                    <TextBlock Text="&#xE946;" FontFamily="Segoe MDL2 Assets" FontSize="16" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <TextBlock Text="MONITOREO ACTIVO" FontSize="16" FontWeight="Bold" 
                                           Foreground="#4DA8DA" VerticalAlignment="Center" />
                            </StackPanel>

                            <!-- Monitoring List with Scroll -->
                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                                <StackPanel>
                                    <!-- Ataques DDoS -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="NetworkViewer_Click" ToolTip="Click para ver conexiones sospechosas">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="Actividad de Red (DDoS)" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Fugas y Ataques" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckConnectionsTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckConnectionsBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckConnectionsDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckConnectionsCount" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Navegador Predeterminado -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="ViewDefaultApps_Click"
                                            ToolTip="Click para abrir configuración del sistema">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE774;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock x:Name="BrowserTitleText" Text="Navegador Predeterminado" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock x:Name="BrowserNameText" Text="..." Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckBrowserTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckBrowserBadge" CornerRadius="10" Background="#27AE60" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckBrowserDot" Width="6" Height="6" Fill="#5CFF5C" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckBrowserStatus" Text="Activo" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Acceso a Cámara y Micrófono -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="Privacy_Click" ToolTip="Click para el Centro de Privacidad">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE890;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="Privacidad (Cámara/Mic)" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Uso de Dispositivos" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckPrivacyTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckPrivacyBadge" CornerRadius="10" Background="#27AE60" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckPrivacyDot" Width="6" Height="6" Fill="#5CFF5C" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckPrivacyStatus" Text="Activo" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Windows Defender -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="ViewDefenderHome_Click" ToolTip="Click para abrir Seguridad de Windows">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE83F;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="Seguridad de Windows" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Microsoft Defender UI" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckDefenseTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckDefenseBadge" CornerRadius="10" Background="#27AE60" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckDefenseDot" Width="6" Height="6" Fill="#5CFF5C" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckDefenseStatus" Text="Activo" Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Exclusiones de Defender -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="ViewExclusions_Click" ToolTip="Click para gestionar exclusiones">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xED1A;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock x:Name="ExclusionsTitleText" Text="Exclusiones de Defender" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Rutas Permitidas" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckExclusionsTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckExclusionsBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckExclusionsDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckExclusionsCount" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Programas al Inicio -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="StartupManager_Click" ToolTip="Click para gestionar programas de inicio">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE7B8;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock x:Name="StartupTitleText" Text="Programas al Inicio" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Auto-arranque de Apps" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckStartupTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckStartupBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckStartupDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckStartupCount" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Tareas Programadas -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="ScheduledTasks_Click" ToolTip="Click para gestionar tareas programadas">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE8A5;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock x:Name="TasksTitleText" Text="Tareas Programadas" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Ejecución en segundo plano" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckTasksTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckTasksBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckTasksDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckTasksCount" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- Windows Script Host (WSH) Status -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="Quarantine_Click" ToolTip="Click para gestionar Windows Script Host">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE943;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="Windows Script Host" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="Bloqueo VBS/JS" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckWshTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckWshBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckWshDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckWshStatus" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>

                                    <!-- HOSTS Mapping -->
                                    <Border Background="#0D1B2A" CornerRadius="8" Padding="12,10" Margin="0,0,0,8"
                                            Cursor="Hand" MouseLeftButtonUp="ViewHosts_Click" ToolTip="Click para editar archivo HOSTS">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Width="40" Height="40" CornerRadius="8" Background="#1A3A5A" Margin="0,0,12,0">
                                                <TextBlock Text="&#xE909;" FontFamily="Segoe MDL2 Assets" FontSize="20" Foreground="#4DA8DA" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="Mapeo de Nombres (HOSTS)" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="13"/>
                                                <TextBlock Text="DNS Local y Bloqueos" Foreground="#7EB8DC" FontSize="11"/>
                                            </StackPanel>
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                                <TextBlock x:Name="CheckHostsTime" Text="--:--" Foreground="#7EB8DC" FontSize="11" HorizontalAlignment="Right" Margin="0,0,0,4"/>
                                                <Border x:Name="CheckHostsBadge" CornerRadius="10" Background="#1E3A5F" Padding="10,3">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Ellipse x:Name="CheckHostsDot" Width="6" Height="6" Fill="#4DA8DA" Margin="0,0,5,0"/>
                                                        <TextBlock x:Name="CheckHostsCount" Text="..." Foreground="White" FontSize="11" FontWeight="SemiBold"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </StackPanel>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>

                <!-- ═══════════════════ FOOTER ═══════════════════ -->
                <Border Grid.Row="2" Margin="0,20,0,0" Padding="18,12" 
                        Background="#0A1525" CornerRadius="8"
                        BorderBrush="#1E3A5F" BorderThickness="1">
                    <Grid>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock x:Name="VersionText" Text="Imperial Shield" 
                                       Foreground="#5A7A9A" FontWeight="SemiBold"
                                       Cursor="Hand" MouseLeftButtonUp="VersionText_Click"
                                       ToolTip="Click para abrir Panel de Pruebas (Debug)"/>
                            <TextBlock Text=" • " Foreground="#3A5A7A"/>
                            <Ellipse x:Name="FooterStatusDot" Width="8" Height="8" Fill="#27AE60" Margin="0,0,6,0" VerticalAlignment="Center">
                                <Ellipse.Effect>
                                    <DropShadowEffect x:Name="FooterStatusGlow" BlurRadius="5" ShadowDepth="0" Color="#27AE60"/>
                                </Ellipse.Effect>
                            </Ellipse>
                            <TextBlock x:Name="FooterStatusText" Text="Monitoreo Activo" Foreground="#27AE60" FontWeight="SemiBold"/>
                        </StackPanel>
                        
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="ExitDefenseBtn" Click="ExitApp_Click" Background="Transparent" 
                                    BorderThickness="0" Cursor="Hand" FontWeight="Bold" Margin="0,0,20,0">
                                <Button.Content>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="✖" Foreground="#F43F5E" FontWeight="Bold" Margin="0,0,5,0"/>
                                        <TextBlock Text="Detener Defensa" Foreground="#F43F5E" FontWeight="Bold" FontSize="12"/>
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                            
                            <Button Content="⚙️ Configuración" Background="Transparent" 
                                    Foreground="#7EB8DC" BorderThickness="0" Cursor="Hand" 
                                    Margin="0,0,20,0" Click="Settings_Click" FontWeight="SemiBold" FontSize="11"/>
                                    
                            <Button Content=" Minimizar" Background="Transparent" 
                                    Foreground="#7EB8DC" BorderThickness="0" Cursor="Hand"
                                    Click="MinimizeToTray_Click" FontWeight="SemiBold" FontSize="11"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
