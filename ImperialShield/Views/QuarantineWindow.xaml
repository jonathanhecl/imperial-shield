<Window x:Class="ImperialShield.Views.QuarantineWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="üîí Centro de Cuarentena - Imperial Shield" 
        Height="750" Width="950"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource ModernWindow}">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>

    <Grid Background="{StaticResource BackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Padding="25" Background="{StaticResource EpicHeaderGradient}" BorderBrush="#4DA8DA" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="üîí" FontSize="36" Margin="0,0,20,0" VerticalAlignment="Center"/>
                <StackPanel>
                    <TextBlock Text="CENTRO DE CUARENTENA" FontSize="22" FontWeight="Bold" Foreground="#4DA8DA"/>
                    <TextBlock Text="Bloquea scripts maliciosos y ejecutables peligrosos" Foreground="#94A3B8"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="20">
            <StackPanel>
                
                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê VBS/SCRIPT BLOCKING SECTION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <Border Style="{StaticResource RPGCard}" Margin="0,0,0,20">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="üìú" FontSize="28" Margin="0,0,15,0" VerticalAlignment="Center"/>
                            <StackPanel>
                                <TextBlock Text="BLOQUEO DE SCRIPTS (VBS/JS)" FontSize="18" FontWeight="Bold" Foreground="#4DA8DA"/>
                                <TextBlock Text="Deshabilita Windows Script Host para prevenir virus de script" Foreground="#94A3B8" FontSize="12"/>
                            </StackPanel>
                        </StackPanel>

                        <Border Grid.Row="1" Background="#0D1B2A" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel>
                                    <TextBlock Text="Estado de Windows Script Host:" Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="14"/>
                                    <TextBlock x:Name="VBSStatusText" Text="Verificando..." Foreground="#94A3B8" FontSize="13" Margin="0,5,0,0"/>
                                    <TextBlock Text="‚ö†Ô∏è Los scripts .vbs y .js son usados frecuentemente por malware." 
                                               Foreground="#F39C12" FontSize="11" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <Button x:Name="VBSToggleButton" Content="DESHABILITAR" 
                                            Click="ToggleVBS_Click" Width="150" Height="45"
                                            Style="{StaticResource SafeButton}" FontSize="14"/>
                                </StackPanel>
                            </Grid>
                        </Border>

                        <TextBlock Grid.Row="2" TextWrapping="Wrap" Foreground="#708090" FontSize="11">
                            <Run FontWeight="SemiBold">Nota:</Run>
                            <Run>Al desactivar WSH, cualquier intento de ejecutar un .vbs mostrar√° un mensaje de error de Windows.</Run>
                            <Run>Esto no afecta a programas leg√≠timos que no usen scripts.</Run>
                        </TextBlock>
                    </Grid>
                </Border>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EXECUTABLE QUARANTINE SECTION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <Border Style="{StaticResource RPGCard}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                            <TextBlock Text="üõë" FontSize="28" Margin="0,0,15,0" VerticalAlignment="Center"/>
                            <StackPanel>
                                <TextBlock Text="CUARENTENA DE EJECUTABLES (IFEO)" FontSize="18" FontWeight="Bold" Foreground="#E74C3C"/>
                                <TextBlock Text="Intercepta y bloquea programas espec√≠ficos antes de que se ejecuten" Foreground="#94A3B8" FontSize="12"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Add New -->
                        <Border Grid.Row="1" Background="#0D1B2A" CornerRadius="8" Padding="15" Margin="0,0,0,15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="NewExeTextBox" 
                                         Background="#1B2838" Foreground="White" 
                                         BorderBrush="#3A5F82" BorderThickness="1"
                                         Padding="12,10" FontSize="14" VerticalContentAlignment="Center"
                                         Text="" ToolTip="Nombre del ejecutable (ej: malware.exe)">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Style.Triggers>
                                                <Trigger Property="Text" Value="">
                                                    <Setter Property="Background">
                                                        <Setter.Value>
                                                            <VisualBrush Stretch="None" AlignmentX="Left">
                                                                <VisualBrush.Visual>
                                                                    <TextBlock Text="  Nombre del ejecutable (ej: virus.exe)" 
                                                                               Foreground="#555" FontStyle="Italic" Padding="10,0"/>
                                                                </VisualBrush.Visual>
                                                            </VisualBrush>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                
                                <Button Grid.Column="1" Content="üìÇ" Click="BrowseExe_Click" 
                                        Width="50" Height="42" Margin="10,0,0,0"
                                        Style="{StaticResource ModernButton}" Background="#3A5F82"
                                        ToolTip="Buscar archivo ejecutable"/>
                                
                                <Button Grid.Column="2" Content="‚ûï BLOQUEAR" Click="AddQuarantine_Click" 
                                        Width="140" Height="42" Margin="10,0,0,0"
                                        Style="{StaticResource DangerButton}" FontSize="13"/>
                            </Grid>
                        </Border>

                        <TextBlock Grid.Row="2" Text="Ejecutables en Cuarentena:" 
                                   Foreground="#E8F4FC" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10"/>

                        <!-- Quarantined List -->
                        <DataGrid x:Name="QuarantineGrid" Grid.Row="3" 
                                  AutoGenerateColumns="False" IsReadOnly="True"
                                  Background="Transparent" RowBackground="#0D1B2A" AlternatingRowBackground="#162232"
                                  HeadersVisibility="Column" GridLinesVisibility="None" BorderThickness="0"
                                  MinHeight="200" MaxHeight="350">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Ejecutable" Width="*">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                <TextBlock Text="üõë" FontSize="16" Margin="0,0,10,0"/>
                                                <TextBlock Text="{Binding FileName}" Foreground="White" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                
                                <DataGridTemplateColumn Header="Fecha de Bloqueo" Width="180">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding QuarantineDateFormatted}" Foreground="#B0C4DE" VerticalAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                
                                <DataGridTemplateColumn Header="Acciones" Width="150">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="üîì LIBERAR" Click="ReleaseQuarantine_Click"
                                                    Style="{StaticResource ModernButton}" Background="#27AE60" 
                                                    FontSize="11" Padding="12,6" Tag="{Binding FileName}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                        <TextBlock x:Name="EmptyListText" Grid.Row="3" 
                                   Text="No hay ejecutables en cuarentena" 
                                   Foreground="#555" FontStyle="Italic" FontSize="14"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"
                                   Visibility="Collapsed"/>
                    </Grid>
                </Border>

                <!-- Info Panel -->
                <Border Background="#16202C" CornerRadius="8" Padding="20" Margin="0,20,0,0" BorderBrush="#3A5F82" BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="‚ÑπÔ∏è ¬øC√≥mo funciona la Cuarentena IFEO?" Foreground="#4DA8DA" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                        <TextBlock TextWrapping="Wrap" Foreground="#94A3B8" FontSize="12" LineHeight="20">
                            <Run>Imperial Shield usa</Run>
                            <Run FontWeight="Bold" Foreground="#E8F4FC">Image File Execution Options (IFEO)</Run>
                            <Run>para interceptar ejecutables antes de que Windows los inicie.</Run>
                            <LineBreak/><LineBreak/>
                            <Run>Cuando a√±ades un programa a la cuarentena:</Run>
                            <LineBreak/>
                            <Run>‚Ä¢ El ejecutable</Run>
                            <Run FontWeight="Bold" Foreground="#E74C3C">NO puede ejecutarse</Run>
                            <Run>bajo ninguna circunstancia.</Run>
                            <LineBreak/>
                            <Run>‚Ä¢ Si alguien (o el sistema) intenta abrirlo, Imperial Shield se activa y muestra una alerta.</Run>
                            <LineBreak/>
                            <Run>‚Ä¢ El archivo original</Run>
                            <Run FontWeight="Bold">NO se modifica ni se elimina</Run>
                            <Run>, solo se bloquea su ejecuci√≥n.</Run>
                            <LineBreak/><LineBreak/>
                            <Run FontStyle="Italic" Foreground="#F39C12">‚ö†Ô∏è Requiere permisos de Administrador para funcionar.</Run>
                        </TextBlock>
                    </StackPanel>
                </Border>
                
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
