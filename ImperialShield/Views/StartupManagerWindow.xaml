<Window x:Class="ImperialShield.Views.StartupManagerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Gestor de Inicio - Imperial Shield" 
        Height="600" Width="900"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource ModernWindow}">

    <Grid Margin="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,25">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <TextBlock Text="ðŸš€ Gestor de Inicio" FontSize="28" FontWeight="Bold" Foreground="White" Margin="0,0,15,0"/>
                <Border Background="#2E5077" CornerRadius="12" Padding="12,4" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="AppCountText" Text="0 apps" Foreground="#4DA8DA" FontWeight="Bold"/>
                    </StackPanel>
                </Border>
            </StackPanel>
            <TextBlock Text="Gestiona quÃ© aplicaciones se ejecutan al iniciar Windows. Desactiva las que no necesites para acelerar tu PC." 
                       Foreground="{StaticResource TextSecondaryBrush}" FontSize="14" Margin="0,5,0,0"/>
        </StackPanel>

        <!-- List -->
        <Border Grid.Row="1" Style="{StaticResource CardBorder}" Padding="0" Background="#152538">
            <DataGrid x:Name="StartupGrid" Margin="0" SelectionUnit="FullRow" CanUserAddRows="False"
                      Background="Transparent" BorderThickness="0" 
                      RowBackground="Transparent" AlternatingRowBackground="#1A2E45"
                      HeadersVisibility="Column" GridLinesVisibility="None"
                      AutoGenerateColumns="False">
                <DataGrid.Resources>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="#1E3A5F"/>
                        <Setter Property="Foreground" Value="#94A3B8"/>
                        <Setter Property="Padding" Value="15,12"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="BorderBrush" Value="#2E5077"/>
                    </Style>
                    <Style TargetType="DataGridCell">
                        <Setter Property="Padding" Value="15,12"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                         <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#1E3A5F"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Resources>
                
                <DataGrid.Columns>
                    <!-- Nombre y Tipo -->
                    <DataGridTemplateColumn Header="AplicaciÃ³n" Width="2*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="White" FontSize="15"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                        <Border Background="#1E3A5F" CornerRadius="4" Padding="6,2" Margin="0,0,8,0">
                                            <TextBlock Text="{Binding Type}" FontSize="11" Foreground="#4DA8DA"/>
                                        </Border>
                                        <TextBlock Text="{Binding Status}" FontSize="12" Foreground="{Binding StatusColor}"/>
                                    </StackPanel>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Ruta / Comando -->
                    <DataGridTemplateColumn Header="Comando / Ruta" Width="3*">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Command}" Foreground="#94A3B8" 
                                           TextTrimming="CharacterEllipsis" ToolTip="{Binding Command}"
                                           VerticalAlignment="Center"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>

                    <!-- Acciones (Toggle) -->
                    <DataGridTemplateColumn Header="Estado" Width="120">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="{Binding ActionText}" 
                                        Click="Toggle_Click"
                                        Width="100" Height="30"
                                        FontSize="12" FontWeight="SemiBold"
                                        Cursor="Hand">
                                    <Button.Style>
                                        <Style TargetType="Button">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border x:Name="border" CornerRadius="15" Background="{Binding ActionColor}">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                        <ControlTemplate.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter TargetName="border" Property="Opacity" Value="0.9"/>
                                                            </Trigger>
                                                        </ControlTemplate.Triggers>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>

        <!-- Footer / Status Bar -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                <Ellipse Width="8" Height="8" Fill="#27AE60" Margin="0,0,8,0"/>
                <TextBlock x:Name="LastUpdatedText" Text="Ãšltima actualizaciÃ³n: --:--" Foreground="#94A3B8" FontSize="13"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button Content="ðŸ”„ Actualizar" Click="Refresh_Click" Style="{StaticResource ModernButton}" 
                        Background="Transparent" BorderBrush="#2E5077" BorderThickness="1" Foreground="#4DA8DA"
                        Width="120" Margin="0,0,10,0"/>
                <Button Content="Cerrar" Click="Close_Click" Style="{StaticResource ModernButton}" Width="100"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
